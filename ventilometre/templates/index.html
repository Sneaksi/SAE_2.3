<!DOCTYPE html>
<html lang="fr"> <!-- SpÃ©cifie que le contenu est en franÃ§ais pour les moteurs de recherche et lecteurs dâ€™Ã©cran -->

<head>
    <meta charset="UTF-8"> <!-- Encodage UTF-8 pour supporter les caractÃ¨res spÃ©ciaux comme les accents -->
    <title>VentilomÃ¨tre des Ã‰tudiants</title> <!-- Titre qui apparaÃ®t dans lâ€™onglet du navigateur -->

    <!-- DÃ©but de la feuille de style interne -->
    <style>
        body {
            font-family: 'Segoe UI', sans-serif; /* Police moderne et lisible */
            background-color: #eef2f7; /* Couleur de fond douce pour le confort visuel */
            margin: 0; /* Supprime la marge par dÃ©faut du navigateur */
            padding: 2rem; /* Ajoute de lâ€™espace intÃ©rieur autour du contenu */
            display: flex;
            flex-direction: column; /* Organisation verticale du contenu */
            align-items: center; /* Centrage horizontal du contenu */
        }

        h1 {
            color: #1e3a8a; /* Titre en bleu foncÃ© pour attirer lâ€™attention */
            text-align: center;
        }

        .logo {
            font-size: 40px; /* Taille du logo emoji ğŸŒ€ */
        }

        form {
            margin-top: 2rem;
            display: flex;
            flex-direction: row; /* Les Ã©lÃ©ments du formulaire sont alignÃ©s horizontalement */
            gap: 10px; /* Espacement entre les champs */
        }

        input[type=text] {
            padding: 10px;
            width: 300px; /* Largeur fixe du champ de recherche */
            border-radius: 6px;
            border: 1px solid #ccc; /* Bordure grise claire */
        }

        button {
            padding: 10px 20px;
            background-color: #1e40af; /* Bleu vif pour se dÃ©marquer */
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer; /* Change le curseur en main au survol */
        }

        .students-link {
            margin-top: 1.5rem;
            text-align: center;
        }

        .students-link a {
            color: #3b3b5c;
            text-decoration: none; /* Pas de soulignement de base */
            font-weight: bold;
        }

        .students-link a:hover {
            text-decoration: underline; /* Apparition du soulignement au survol */
        }

        .result, .history {
            margin-top: 30px;
            padding: 20px;
            background: white;
            border-radius: 8px;
            width: 80%; /* Sâ€™adapte Ã  lâ€™Ã©cran jusquâ€™Ã  800px */
            max-width: 800px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1); /* LÃ©gÃ¨re ombre pour dÃ©tacher le bloc visuellement */
        }

        .vent-median {
            margin-top: 10px;
            font-size: 1.1rem;
            color: #1e3a8a;
            background-color: #fff;
            padding: 10px 20px;
            border-radius: 6px;
            box-shadow: 0 0 5px rgba(0,0,0,0.1);
        }

        ul {
            list-style-type: none; /* Supprime les puces de la liste */
            padding-left: 0;
        }

        li {
            margin: 5px 0;
        }

        .btn-clear {
            margin-top: 10px;
            background-color: #c0392b; /* Rouge pour montrer que lâ€™action est risquÃ©e/supprime des donnÃ©es */
        }
    </style>
</head>

<body>
    <!-- Logo emoji affichÃ© en haut -->
    <div class="logo">ğŸŒ€</div>

    <!-- Titre principal de la page -->
    <h1>VentilomÃ¨tre des Ã‰tudiants</h1>

    <!-- Bloc conditionnel : affichÃ© seulement si une valeur collective de vent est disponible -->
    {% if vent_collectif %}
    <div class="vent-median">
        ğŸŒ VentilomÃ¨tre collectif du jour : <strong>{{ vent_collectif }} m/s</strong>
    </div>
    {% endif %}

    <!-- Formulaire de recherche dâ€™un Ã©tudiant par son nom -->
    <form method="POST"> <!-- Les donnÃ©es sont envoyÃ©es au serveur en POST -->
        <input type="text" name="nom" placeholder="Nom de l'Ã©tudiant" required> <!-- Champ de saisie obligatoire -->
        <button type="submit">ğŸ” Rechercher</button> <!-- Bouton avec emoji loupe -->
    </form>

    <!-- Lien vers la page listant tous les Ã©tudiants -->
    <div class="students-link">
        <p>ğŸ“„ <a href="{{ url_for('etudiants') }}">Voir tous les Ã©tudiants</a></p>
    </div>

    <!-- Affiche le rÃ©sultat de la recherche si un Ã©tudiant est trouvÃ© -->
    {% if result %}
    <div class="result">
        <h2>RÃ©sultat pour {{ result.nom }} {{ result.prenom }}</h2>
        <p>ğŸ“ RÃ©sidence principale : {{ result.ville1 }} â€” Vent : {{ result.vent1 }} m/s</p>

        <!-- RÃ©sidence secondaire, seulement si elle est dÃ©finie -->
        {% if result.ville2 %}
        <p>ğŸ  RÃ©sidence secondaire : {{ result.ville2 }} â€” Vent : {{ result.vent2 }} m/s</p>
        {% endif %}
    </div>
    {% endif %}

    <!-- Historique personnel : les recherches effectuÃ©es par lâ€™utilisateur courant -->
    {% if historique_utilisateur %}
    <div class="history">
        <h2>ğŸ•’ Historique personnel</h2>
        <ul>
            {% for h in historique_utilisateur %}
            <li>
                {{ h[6] }} â€“ <strong>{{ h[1] }} {{ result.prenom }}</strong> :
                {{ h[2] }} ({{ h[3] }} m/s)
                {% if h[4] %}/ {{ h[4] }} ({{ h[5] }} m/s){% endif %}
            </li>
            {% endfor %}
        </ul>
    </div>
    {% endif %}

    <!-- Historique global : toutes les recherches concernant un Ã©tudiant -->
    {% if historique %}
    <div class="history">
        <h2>ğŸ§¾ Historique global de {{ result.nom }} {{ result.prenom }}</h2>
        <ul>
            {% for r in historique %}
            <li>
                {{ r[6] }} â€“ <strong>{{ r[1] }} {{ result.prenom }}</strong> :
                {{ r[2] }} ({{ r[3] }} m/s)
                {% if r[4] %}/ {{ r[4] }} ({{ r[5] }} m/s){% endif %}
            </li>
            {% endfor %}
        </ul>

        <!-- Bouton de suppression de lâ€™historique -->
        <form method="POST" action="{{ url_for('clear_history') }}">
            <button class="btn-clear">ğŸ—‘ï¸ Vider l'historique</button>
        </form>
    </div>
    {% endif %}
</body>
</html>
